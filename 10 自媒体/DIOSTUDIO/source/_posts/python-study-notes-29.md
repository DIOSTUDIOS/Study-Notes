---
title: Python 3 学习笔记：MongoDB 简介
tags: [Python, NoSQL, MongoDB, RDBMS]
date: 2019-08-30 11:29:56
---

> 人生苦短，我用 Python

MongoDB 是一款基于分布式文件存储的数据库，使用 C++ 编写，旨在为 Web 应用提供可扩展的高性能数据库存储解决方案。MongoDB 是一款介于关系型数据库与非关系型数据库之间的产品，是非关系型数据库中功能最丰富，最像关系型数据库的。

# NoSQL

NoSQL（Not Only SQL），是一项全新的数据库革命性运行，发展至 2009 年趋势越发高涨。

NoSQL 指非关系型数据库。是对不同于传统的关系型数据库的数据库管理系统的统称。其被用于超大规模数据的存储，这类数据存储时不需要固定的模式，无需多余操作就可以横向扩展。

## RDBMS & NoSQL

### RDBMS

- 高度组织化、结构化数据
- 结构化查询语言
- 数据和关系存储在单独的表中
- 数据操纵语言，数据定义语言
- 严格的一致性
- 基础事物

### NoSQL

- 代表着不仅仅是 SQL
- 没有声明查询语言
- 没有预定义的模式
- *键-值* 对存储，列存储，文档存储，图形数据库
- 最终一致性，而非 ACID 原则
- 非结构化和不可预知的数据
- CAP 理论
- 高性能、高可用性和可伸缩性

## CAP 理论

CAP 理论指出对于一个分布式计算系统而言，不可能同时满足以下三点：

- 一致性（Consistency），所有节点在同一数据具有相同的数据
- 可用性（Availability），保证每个请求不管成功或者失败都被响应
- 分区容错（Partition tolerance），系统中任意信息的丢失或失败不会影响系统的持续运作

CAP 理论的核心是一个分布式系统不可能同时很好的满足以上三点，最多只能同时较好的满足两个。因此，根据 CAP 理论将 NoSQL 数据库分成了满足 CA、CP 和 AP 三大类。

- CA，单点集群，通常在可扩展性上不太强大
- CP，通常性能不是特别高
- AP，对一致性要求低一些

## 优点 & 缺点

### 优点

- 高可扩展性
- 分布式计算
- 低成本
- 架构灵活，半结构化数据
- 没有复杂的关系

### 缺点

- 没有标准化
- 有限的查询功能
- 最终一致是不直观的程序

## BASE 原则

根据 CAP 理论一个分布式熊不可能同时很好的满足一致性、可用性和分区容错这三个要求，最多只能同时较好的满足其中两个。所以，NoSQL 数据库对一致性和可用性提出了 BASE 弱要求原则：

- Basically Avaible，基本可用
- Soft state，软状态/柔性事物
- Eventual Consistency，最终一致性

# MongoDB

## 简介

MongoDB 是一个基于分布式文件存储的开源数据库系统，在高负载的情况下，添加更多的节点，可以保证服务器的性能。MongoDB 将数据存储为一个文档，数据结构由 *键-值*（key:value）对组成。MongoDB 文档类似于 JSON 对象，字段值可以包含其他文档、数据及文档数据。

![数据结构.jpg](https://i.loli.net/2019/08/30/pr6PEhqWCBM8aSn.jpg)

## 主要特点

- 一款面向文档存储的数据库，操作起来比较简单容易
- 可以在记录中设置任何属性的索引来实现更快的排序
- 可以通过本地或者网络创建数据镜像，这使得 MongoDB 有更强的扩展性
- 如果负载的增加（需要更多的存储空间和更强的处理能力） ，它可以分布在计算机网络中的其他节点上
- 支持丰富的查询表达式，查询指令使用 JSON 形式的标记，可轻易查询文档中内嵌的对象及数组
- 使用 update 命令可以实现替换完成的文档（数据）或者一些指定的数据字段 
- Mongodb 中的 Map/Reduce 主要是用来对数据进行批量处理和聚合操作
- Map 函数调用 emit(key,value) 遍历集合中所有的记录，将 key 与 value 传给 Reduce 函数进行处理
- Map 函数和 Reduce 函数使用 Javascript 编写，并可以通过 db.runCommand 或 mapreduce 命令来执行 MapReduce 操作
- GridFS 是 MongoDB 中的一个内置功能，可以用于存放大量小文件
- 允许在服务端执行脚本，可以用 Javascript 编写某个函数，直接在服务端执行，也可以把函数的定义存储在服务端下次直接调用即可
- 支持各种编程语言，如 RUBY，PYTHON，JAVA，C++，PHP，C# 等
- 安装简单

## 概念解析

在 MongoDB 中基本的概念是数据库、集合、文档，

![基本概念.jpg](https://i.loli.net/2019/08/30/PzoIjB9F37exWEt.jpg)

### 数据库

一个 MongoDB 系统中可以建立多个数据库，每个数据库相互独立，拥有自己的集合与权限，被放置在不同的文件中。命名数据库应该遵循以下原则：

- 不能是空字符串
- 不能含有某些特殊符号
- 应全部小写
- 最多 64 字节

下面的数据库名是系统保留的，不能被使用：

- admin
- local
- config

### 集合

集合类似于关系型数据库系统中的表，但是集合没有固定的结构，可以插入不同格式和类型的数据，但是通常情况下插入集合中的数据都具有一定的关联性。集合只有在插入一个文档之后，才会被创建。集合的命名规则如下：

- 不能包含空字符串
- 不能使用某些特殊字符
- 不能以 system. 开头（此为系统保留的前缀）
- 不能包含保留字符

### 文档

文档是一组 *键-值* 对，MongoDB 的文档不需要设置相同的字段，而且相同的字段不需要相同的数据类型，需要注意的是：

- 文档中的 键-值 对是有序的
- 值 可以是字符串，也可以是其他数据类型，或者是另一个文档
- 区分类型和大小写
- 不能使用重复的键
- 键是字符串，少数情况下可以使用任意 UTF-8 字符

命名规范如下：

- 不能含有空字符
- . 和 $ 有特殊的意义，只有在特殊情况下可以使用
- 以下划线开头的键是保留的（不是严格要求的）

## 数据类型

![数据类型.jpg](https://i.loli.net/2019/08/30/GiWAeH724OtKDVp.jpg)





------

<div align="center">
    ![自媒平台.jpg](https://i.loli.net/2019/07/29/5d3ea08e5052e51593.jpg)
</div>

